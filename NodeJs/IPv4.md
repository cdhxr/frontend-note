
- IP 是指互联网协议，指整个网络层，讨论如何将一个package从一个endpoint发送到另一个endpoint
- IP Address 是指每台计算机与在互联网上的地址，每台计算机有一台唯一的IP地址
- 口语上常常将IP代指IP地址

IP Address有两个主要版本IPv6和IPv4

# IPv4

32bit，每8bit，作为一个部分，每一位可以是0/1

`00000000.00000000.00000000.00000000`

存在2的32次方个IP地址，（42亿以上个）现在已经用完了，于是出现了IPv6

IP地址分为两个部分，网络号和主机号

子网掩码决定了，网络号和主机号分别占几位

`1111111.1111111.00000000.00000000`

子网掩码的形式固定，必须是一串连续的1代表网络号，连续的0代表主机号

![[Pasted image 20250524234005.png]]

混合写法：IP地址/网络号位数（子网掩码1的个数），如上

网络号标识网络，主机号标识主机，上图中的网络最多有主机254个主机
（8bit，
	- 去掉全0的一种情况，全0意味着空的网络，没分配主机号，
	- 去掉全1，主机号全为 1，被**保留用于广播地址**（Broadcast Address），向某个网络上的所有主机发送数据
    ）

# Private IPv4 Address

![[Pasted image 20250525110343.png]]

互联网是无法访问到私人地址的，所有的ISP（互联网服务提供商），会阻止这些地址被访问，数据不会从这里被write到公共部分，会被ISP block

当一个公司的200个设备，会连接到同一个路由器，路由器拥有一个public IP Address，而这些设备会从Private IP address中分配IP地址，当其与路由器连接时，再分配给它一个Private IP Address

这样做的好处是，不用为所有机子分配单独的IP地址，而是在不同地方复用这些私有IP地址，可以节省IP地址的使用分配

LoopBack Address事实上浪费了16million个地址，完全没必要，IPv6中只有一个，避免了此错误

![[Pasted image 20250525114813.png]]

假设要发送一个数据包：

- 如果与目标网络号一致，那么意味着他们在相同网络中，所以不需要发送至另一个网络
- send a request，到所有该网络内的设备，得出这些IP地址所对应的MAC地址
- 匹配目标地址相同的IP地址，MAC地址
- 然后使用交换机（router内置），发送数据包

- 如果网络号不一致，意味着在不同的网络中
- 需要检查table，路由器有包含所有网络号的表，找到对应的网络号所在的位置
- 取决于网络号的不同，他们会发送到不同的位置
- 路由器收到网络号一致的数据包时，就会执行上面的情况

NAT: network address translation，在路由器中的程序，将Private IP Address 转换为Public IP Address

VPN做的事情是，将你的机器所有的数据流量转发至另一个机器，然后这个机器会出现在所有的与你通信的服务器上，仿佛你在那个机器的服务器上，而不是在你自己的机器上

VPN工作在网络层，NodeJS在TCP,UDP上面的层级，所以VPN是无法用NodeJS实现的，或许需要用C,C++等更底层的语言

IP地址事实上是按地区和公司分配的，美国有1billion个，朝鲜只有1024个（难绷）

# IPv6

变化都是在网络层，其他层不需要为IPv6重新调整变化

128bits，通常用16进制简化写法
- 对于每个部分，可以删除所有的前置0，
- 可以删除一次连续的0（保留两个冒号）
- 只有一个loopback地址，::1
- IPv6很多，所以没有子网掩码