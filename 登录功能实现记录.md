
登录机制：
- 在服务器上用户被验证后，即用户发送了有效的凭据对
- 在后端（服务器），创建一个，但不存储，“准许” token (算法创建的字符串，存储着一些信息)，发送它到前端（客户端）
- 这个token的有效性只能由创建它的后端验证，因为token是使用后端的私钥创建的，这个私钥只有后端知道
- 在未来的请求中，从客户端到后端，我们将该请求附加至这些请求中
- 并且后端能够查看那个令牌

注意点：
- 刷新登录状态不会掉

接口：

- 获取用户信息GET:   /capi/user/info
- 用户登录POST:       /capi/user/public/login
- 用户注册POST:       /capi/user/public/register

- 用户接口名
	- ![[Pasted image 20250402105424.png]]

触发了某个事件（点击了某个按钮，链接，跳转至某个界面......）

=>转入登录page or 跳出了登录弹窗（return 登录组件tsx）

登录组件状态与用户状态：

| 用户状态 | 触发条件            | 典型 UI 表现                       |     |
| ---- | --------------- | ------------------------------ | --- |
| 未登录  | 初始状态 / Token 无效 | 需要显示 **登录表单** 或 **OAuth 登录按钮** |     |
| 登录中  | 用户提交凭据          | 显示 "登录中…"                      |     |
| 登录成功 | 认证成功，JWT 存储     | 显示用户主页                         |     |
| 登录失败 | 密码错误 / OAuth 失败 | 显示错误消息                         |     |
| 登录过期 | JWT 失效          | 重新登录或刷新 Token                  |     |
| 已登出  | 用户主动退出          | 回到登录页                          |     |

### **1. 未登录（未认证 - Unauthenticated）**

- 需要显示 **登录表单** 或 **OAuth 登录按钮**。  
- 访问受限页面时，重定向到 **登录页**。 

### **2. 登录中（认证进行中 - Authenticating）**

- 显示 **"加载中…"** 或 **"正在登录…"** 。
- 禁用登录按钮，避免重复提交。

### **3. 登录成功（已认证 - Authenticated）**

- 用户 **登录成功**，JWT 存储在 **localStorage / Cookie**，可用于后续 API 请求。

- 显示 **用户主页** 或 **个人信息**。
- 允许访问 **受保护页面**。
- **导航到首页或目标页面**。

### **4. 登录失败（认证失败 - Authentication Failed）**

- **账号或密码错误**，或者 OAuth 授权失败。
- **表现**：
    
    - 显示错误提示（如 **"账号或密码错误"**）。
    - 允许用户重新输入并再次尝试。

### **5. 登录过期（认证过期 - Token Expired）**

- **JWT 过期** 或 **Session 失效**。
- **表现**：
    
    - 自动 **登出** 并跳转到登录页。
    - 或者 **自动刷新 Token**（如果支持 Refresh Token）。

### **6. 已登出（退出登录 - Logged Out）**

- 用户主动点击 **"退出登录"**，或者 **Token 清除**。
- **表现**：
    
    - 清除 Token 和用户数据。
    - 跳转回 **登录页**。
