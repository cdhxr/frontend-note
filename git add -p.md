
`git add -p` 是 Git 中一个非常实用的命令，用于 **按“区块（hunk）”选择性地添加代码到暂存区（staging area）**，而不是一次性把整个文件都 `add` 进去。

---

## 🧠 简单理解：

> `git add -p` 让你可以 **逐个变更地决定是否提交某部分代码**，实现更细粒度的提交控制。

---

## ✅ 使用场景示例：

比如你改了一个文件 `index.tsx`，里面同时做了两件事：

- 修复了一个 bug；
    
- 添加了一些新功能。
    

你希望分开提交这两个改动，但它们都在同一个文件里：

```bash
git diff
```

你会看到这些改动。

然后运行：

```bash
git add -p
```

Git 就会一个一个“变更块”地问你：

```bash
Stage this hunk [y,n,q,a,d,s,e,?]?
```

---

## 🧾 选项含义：

|输入键|含义|
|---|---|
|`y`|yes，添加该变更块到暂存区|
|`n`|no，跳过该变更块|
|`q`|quit，退出，不处理剩下的变更|
|`a`|all，添加**剩下所有变更块**|
|`d`|don't add any，跳过剩下所有变更块|
|`s`|split，将当前变更块细分为更小块（如果可能）|
|`e`|edit，手动编辑当前变更块|
|`?`|帮助，显示这些选项|

---

## 🧠 举个具体例子：

你运行：

```bash
git add -p
```

看到：

```diff
@@ -10,6 +10,9 @@
   function handleClick() {
     // some code
   }

+  // Temporary debug log
+  console.log("clicked");
+
```

你不想把 debug log 提交进去，就输入：

```
n
```

然后 Git 会继续问下一个变更，直到你选 `y` 或 `q`。

---

## ✅ 实际用途（非常有用）：

- 将**不相关的变更分开提交**；
    
- 避免把临时代码（如 console.log）误提交；
    
- 保持 Git 历史**干净、可读、清晰**；
    
- 跟 `git commit -m "描述"` 配合，生成清晰的提交记录。
    

---

## ✅ Bonus：结合 GUI 工具（VS Code）

如果你不喜欢命令行，VS Code 的 `Source Control` 视图也支持 **每个变更块旁边点 `+` 添加到暂存区**，本质上就是 `git add -p` 的图形化版本。

---

需要我给你演示一次交互式 `git add -p` 的全过程吗？还是帮你写个常用场景操作清单？